from mongoengine import StringField, ListField
from katti.DataBaseStuff.MongoengineDocuments.BaseDocuments import AbstractNormalDocument


class MalwareFamilyMapping(AbstractNormalDocument):
    meta = {'collection': 'malware_family_mapping'}
    name = StringField(required=True)
    variants = ListField()

    @staticmethod
    def get_family_mapping(name_from_source: str):
        try:
            name = MalwareFamilyMapping.objects.only('name').get(__raw__={'variants': name_from_source})
        except Exception:
            return name_from_source
        else:
            return name.name
